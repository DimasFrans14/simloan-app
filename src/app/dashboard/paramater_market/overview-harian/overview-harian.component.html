<div>
  <app-header></app-header>
  <app-sidebar></app-sidebar>
  <!-- sub header -->
  <div id="header" class="header">
    <div class="col-12 bg-white sub-nav border-top">
      <div class="d-flex flex-col justify-content-between align-items-center">
        <div>
          <button class="btn btn-primary" style="font-size: 14px">
            Harian
          </button>
          <a
            routerLink="/overview_trending"
            class="btn btn-light bg-white ms-2 text-dark"
            style="font-size: 14px"
            >Trending</a
          >
          <mat-form-field class="ms-2 input-date">
            <mat-label class="label-datepicker">Pilih Tanggal</mat-label>
            <input
              matInput
              [matDatepicker]="picker1"
              autocomplete="off"
              (dateChange)="onDate($event)"
              disabled
              style="color: black"
            />
            <mat-datepicker-toggle
              matSuffix
              [for]="picker1"
            ></mat-datepicker-toggle>
            <mat-datepicker
              #picker1
              color="primary"
              disabled="false"
            ></mat-datepicker>
          </mat-form-field>
          <!-- <input type="date" name="date" id="input_date" class="bg-white rounded border-none ms-2" placeholder="Pilih Tanggal" #date (change)="getDate(date.value)"> -->
          <!-- <button class="btn btn-light bg-white border border-1 ms-2 text-dark" type="button" data-bs-toggle="modal" data-bs-target="#exampleModal">Filter Tanggal</button> -->
          <!-- <button class="btn btn-transparant border border-1 dropdown-toggle ms-2" type="button" data-bs-toggle="dropdown" aria-expanded="false">
              Filter Tanggal
            </button> -->
          <div class="dropdown-menu">
            <form (ngSubmit)="onSubmit($event)">
              <span
                class="text-secondary"
                [style.display]="dateVal ? 'none' : 'block'"
                >Hari</span
              >
              <div
                class="mb-3 form-check"
                [style.display]="dateVal ? 'none' : 'block'"
              >
                <input type="checkbox" class="form-check-input" id="7hari" />
                <label
                  class="form-check-label"
                  for="exampleCheck1"
                  value="7hari"
                  >7 Hari</label
                >
                <br />
                <input type="checkbox" class="form-check-input" id="30hari" />
                <label
                  class="form-check-label"
                  for="exampleCheck2"
                  value="30hari"
                  >30 Hari</label
                >
                <br />
                <input type="checkbox" class="form-check-input" id="90hari" />
                <label
                  class="form-check-label"
                  for="exampleCheck3"
                  value="90hari"
                  >90 Hari</label
                >
              </div>
              <span class="text-secondary">Bulan</span>
              <br />
              <div class="mb-3 form-check">
                <input
                  type="checkbox"
                  class="form-check-input"
                  id="bulanLalu"
                />
                <label
                  class="form-check-label"
                  for="exampleCheck1"
                  value="bulanLalu"
                  >Bulan Lalu</label
                >
                <br />
                <input
                  type="checkbox"
                  class="form-check-input"
                  id="akhirBulan"
                />
                <label
                  class="form-check-label"
                  for="exampleCheck2"
                  value="akhirBulan"
                  >Akhir Bulan</label
                >
                <br />
                <input type="checkbox" class="form-check-input" id="12Bulan" />
                <label
                  class="form-check-label"
                  for="exampleCheck3"
                  value="12Bulan"
                  >12 Bulan</label
                >
              </div>
              <input type="checkbox" class="form-check-input" id="tri1" />
              <label
                class="form-check-label text-secondary ms-1"
                for="exampleCheck1"
                value="bulan"
                >Bulan</label
              >
              <br />
              <select
                name="monthFilter"
                id="monthFilter"
                class="p-2 rounded border-dark my-2"
                style="width: 100%"
              >
                <option value="" *ngFor="let month of filteredMonth">
                  {{ month.month }}
                </option>
              </select>
              <br />
              <span class="text-secondary">Triwulan</span>
              <div class="mb-3 form-check">
                <input type="checkbox" class="form-check-input" id="tri1" />
                <label class="form-check-label" for="exampleCheck1" value="tri1"
                  >Triwulan I (Jan - Mar)</label
                >
                <br />
                <input type="checkbox" class="form-check-input" id="tri2" />
                <label class="form-check-label" for="exampleCheck2" value="tri2"
                  >Triwulan II (Apr - Jun)</label
                >
                <br />
                <input type="checkbox" class="form-check-input" id="tri3" />
                <label class="form-check-label" for="exampleCheck3" value="tri3"
                  >Triwulan III (Jul - Sep)</label
                >
                <br />
                <input type="checkbox" class="form-check-input" id="tri4" />
                <label class="form-check-label" for="exampleCheck3" value="tri4"
                  >Triwulan IV (Okt - Des)</label
                >
              </div>
              <button type="submit" class="btn btn-primary">Cari</button>
            </form>
          </div>
        </div>
        <div style="font-size: 14px">
          <p>Indikator:</p>
          <div class="d-flex align-items-center justify-content-center">
            <div>
              <span class="text-danger me-2 fw-semibold">RKAP</span>
            </div>
            <div>
              <img src="assets/icon/bullet.svg" alt="" class="me-2" />
            </div>
            <div>
              <span class="text-primary me-2 fw-semibold">Realisasi</span>
            </div>
            <div>
              <img src="assets/icon/bullet.svg" alt="" class="me-2" />
            </div>
            <div>
              <span class="text-secondary fw-semibold">Outlook</span>
            </div>
          </div>
        </div>
        <div style="font-size: 12px">
          <span
            ><i class="bi bi-circle-fill text-success me-2"></i>On Track</span
          ><br />
          <span
            ><i class="bi bi-circle-fill text-warning me-2"></i>â‰¤5%
            Underperformance</span
          ><br />
          <span
            ><i class="bi bi-circle-fill text-danger me-2"></i>>5%
            Underperformance</span
          >
        </div>
        <div>
          <button
            class="bg-light rounded p-3"
            style="border: none"
            type="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
          >
            <i class="bi bi-download"></i>
          </button>
          <ul class="dropdown-menu border border-1">
            <!-- <li style="cursor: pointer" (click)="getPPT()">
              <a class="dropdown-item"
                ><i class="bi bi-filetype-ppt me-2"></i>PPT</a
              >
            </li> -->
            <li style="cursor: pointer" (click)="captureAndConvertToPDF()">
              <a class="dropdown-item"
                ><i class="bi bi-filetype-pdf me-2"></i>PDF</a
              >
            </li>
          </ul>
        </div>
        <div></div>
      </div>
    </div>
  </div>
  <!-- End Sub header -->
  <main id="main" class="main">
    <div #screen>
      <div class="d-flex align-items-center justify-content-between mt-4 mb-2">
        <div>
          <h4>Macro Indicator</h4>
        </div>

        <div>
          <button
            class="btn btn-light bg-white"
            data-bs-toggle="modal"
            data-bs-target="#macroIndicatorModal"
            style="font-size: 14px"
            [style.display]="isCapture ? 'none' : 'block'"
          >
            Edit
          </button>
        </div>
      </div>

      <div
        class="modal fade"
        id="macroIndicatorModal"
        tabindex="-1"
        aria-labelledby="macroIndicatorModalLabel"
        aria-hidden="true"
        data-bs-backdrop="true"
      >
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5">Macro Indicator</h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body overflow-y-auto">
              <!-- <div class="search search-bar" style="margin-bottom: 28px;">
              <form class="search-form" method="POST" action="#">
                <input type="text" name="query" placeholder="Search" title="Enter search keyword">
                <button type="submit" title="Search"><i class="bi bi-search"></i></button>
              </form>
            </div> -->
              <!-- <ng-select [items]="dataMacroIndicator"
           bindLabel="kode"
           bindValue="kode"
           [(ngModel)]="selectedItemsMacro">
            </ng-select> -->
              <div>
                <table class="table">
                  <thead>
                    <tr>
                      <th scope="col" style="font-size: 14px">
                        Macro Indicator
                      </th>
                      <th scope="col" style="font-size: 14px">Realiasi</th>
                      <th scope="col" style="font-size: 14px">RKAP</th>
                      <th scope="col" style="font-size: 14px">Outlook</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let item of listEditMacroIndicator">
                      <td>
                        {{ item.keterangan }}
                      </td>
                      <td>{{ item.nilai_real }}</td>
                      <td>{{ item.nilai_rkap }}</td>
                      <td>{{ item.nilai_outlook }}</td>
                      <td>
                        <i
                          class="bi bi-plus-slash-minus"
                          style="cursor: pointer"
                          (click)="getValueMacroIndicator(item.kode)"
                        ></i>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Tutup
              </button>
              <button type="button" class="btn btn-primary">Simpan</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Card Macro Indicator -->
      <div
        class="d-flex flex-sm-wrap flex-md-wrap flex-lg-nowrap align-items-center justify-content-center"
      >
        <div
          class="text-primary"
          [style.display]="isLoadingMacro ? 'block' : 'none'"
        >
          <div
            class="d-flex align-items-center justify-content-center bg-white rounded"
            style="padding: 50px 140px"
          >
            <div class="spinner-border" role="status"></div>
            <span class="text-dark ms-2">Load Data...</span>
          </div>
        </div>

        <!-- <div *ngIf="defaultMacroIndicatorItems"> -->
        <div
          *ngFor="let items of dataMacroIndicator"
          [style.display]="isLoadingMacro ? 'none' : 'block'"
        >
          <div
            class="d-flex flex-column justify-content-center bg-white rounded p-3 me-3 position-relative mt-2"
          >
            <a
              class="fw-semibold align-self-center text-center mb-3 noteable"
              >{{ items.keterangan }}</a
            >
            <div
              class="d-flex align-items-center justify-content-between pb-2"
              style="font-size: 12px"
            >
              <div
                class="d-flex flex-column align-items-center me-2 text-danger"
              >
                <span>RKAP</span>
                <span>{{ items.nilai_rkap }}</span>
              </div>
              <div
                class="d-flex flex-column align-items-center me-2 text-primary"
              >
                <span>{{ items.alias_periode }}</span>
                <span>{{ items.nilai_real }}</span>
              </div>
              <div class="d-flex flex-column align-items-center text-secondary">
                <span
                  >{{ getQuartal }}{{ getYear }}F<sup>{{
                    items.indikator_tagging
                  }}</sup></span
                >
                <span>{{ items.nilai_outlook }}</span>
              </div>
            </div>
            <div class="circle-card" [style.background]="items.indikator"></div>
          </div>
        </div>
        <!-- </div> -->
      </div>
      <!-- End Card Macro Indicator -->

      <div class="row mt-4">
        <div class="col-4">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h4>Commodity</h4>
            </div>
            <div>
              <button
                class="btn btn-light bg-white"
                data-bs-toggle="modal"
                data-bs-target="#commodityModal"
                style="font-size: 14px"
                [style.display]="isCapture ? 'none' : 'block'"
              >
                Edit
              </button>
            </div>
          </div>

          <div
            class="modal fade"
            id="commodityModal"
            tabindex="-1"
            aria-labelledby="commodityModalLabel"
            aria-hidden="true"
            data-bs-backdrop="true"
          >
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="currenciesModalLabel">
                    Commodity
                  </h1>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                    aria-label="Close"
                  ></button>
                </div>
                <div class="modal-body overflow-y-auto">
                  <!-- <div class="search search-bar" style="margin-bottom: 28px;">
                  <form class="search-form" method="POST" action="#">
                    <input type="text" name="query" placeholder="Search" title="Enter search keyword">
                    <button type="submit" title="Search"><i class="bi bi-search"></i></button>
                  </form>
                </div> -->
                  <!-- <ng-select [items]="listEditCommodities"
               bindLabel="kode_item"
               bindValue="kode_item"
               [(ngModel)]="selectedItems">
                </ng-select> -->
                  <!-- <div *ngFor="let items of defaultMacroIndicatorItems"> -->
                  <div
                    class="d-flex align-items-center justify-content-between"
                  >
                    <table class="table">
                      <thead>
                        <tr>
                          <th scope="col" style="font-size: 14px">
                            Commodities
                          </th>
                          <th scope="col" style="font-size: 14px">Realiasi</th>
                          <th scope="col" style="font-size: 14px">RKAP</th>
                          <th scope="col" style="font-size: 14px">Outlook</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of listEditCommodities">
                          <td
                            scope="row"
                            style="font-size: 14px; border-style: none"
                          >
                            {{ item.keterangan }}
                          </td>
                          <td>{{ item.nilai_realisasi }}</td>
                          <td>{{ item.nilai_rkap }}</td>
                          <td>{{ item.nilai_outlook }}</td>
                          <td>
                            <i
                              class="bi bi-plus-slash-minus"
                              style="cursor: pointer"
                              (click)="getValueRowCommodities(item.kode_item)"
                            ></i>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <!-- </div> -->
                </div>
                <div class="modal-footer">
                  <button
                    type="button"
                    class="btn btn-secondary"
                    data-bs-dismiss="modal"
                  >
                    Tutup
                  </button>
                  <button type="button" class="btn btn-primary">Simpan</button>
                </div>
              </div>
            </div>
          </div>

          <div
            class="text-primary mt-2"
            [style.display]="isLoadingCommodity ? 'block' : 'none'"
          >
            <div
              class="d-flex align-items-center justify-content-center bg-white rounded"
              style="padding: 50px 0px"
            >
              <div class="spinner-border" role="status"></div>
              <span class="text-dark ms-2">Load Data...</span>
            </div>
          </div>

          <!-- Card Commodity -->
          <div
            *ngFor="let item of dataDefaultCommodities"
            [style.display]="isLoadingCommodity ? 'none' : 'block'"
          >
            <!-- <div *ngIf="i < 3"> -->
            <div
              class="d-flex flex-column justify-content-center bg-white rounded p-3 mb-3 mt-2 position-relative"
            >
              <span class="fw-semibold align-self-center mb-3">{{
                item.keterangan
              }}</span>
              <div
                class="d-flex align-items-center justify-content-between"
                style="font-size: 12px"
              >
                <div
                  class="d-flex flex-column align-items-center me-2 text-danger"
                >
                  <span>RKAP</span>
                  <span>{{ item.nilai_rkap }}</span>
                </div>
                <div
                  class="d-flex flex-column align-items-center me-2 text-primary"
                >
                  <span>{{ item.alias_periode }}</span>
                  <span>{{ item.nilai_realisasi }}</span>
                </div>
                <div
                  class="d-flex flex-column align-items-center text-secondary"
                >
                  <span
                    >{{ getQuartal }}{{ getYear }}F<sup>{{
                      item.indikator_tagging
                    }}</sup></span
                  >
                  <span>{{ item.nilai_outlook }}</span>
                </div>
              </div>
              <div
                class="circle-card"
                [style.background]="item.indikator"
              ></div>
            </div>
            <!-- </div> -->
          </div>
        </div>
        <div class="vertical-card col-4">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h4>Currencies</h4>
            </div>
            <div>
              <button
                class="btn btn-light bg-white"
                style="font-size: 14px"
                data-bs-toggle="modal"
                data-bs-target="#currenciesModal"
                [style.display]="isCapture ? 'none' : 'block'"
              >
                Edit
              </button>
            </div>
          </div>

          <div
            class="modal fade"
            id="currenciesModal"
            tabindex="-1"
            aria-labelledby="currenciesModalLabel"
            aria-hidden="true"
            data-bs-backdrop="true"
          >
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="currenciesModalLabel">
                    Currencies
                  </h1>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="modal"
                    aria-label="Close"
                  ></button>
                </div>
                <div class="modal-body overflow-y-auto">
                  <!-- <div class="search search-bar" style="margin-bottom: 28px;">
                  <form class="search-form" method="POST" action="#">
                    <input type="text" name="query" placeholder="Search" title="Enter search keyword">
                    <button type="submit" title="Search"><i class="bi bi-search"></i></button>
                  </form>
                </div> -->
                  <!-- <ng-select [items]="dataCurrency"
               bindLabel="kode"
               bindValue="kode"
               [(ngModel)]="selectedKurs">
                </ng-select> -->
                  <!-- <div *ngFor="let items of defaultMacroIndicatorItems"> -->
                  <div
                    class="d-flex align-items-center justify-content-between"
                  >
                    <table class="table">
                      <thead>
                        <tr>
                          <th scope="col" style="font-size: 14px">Currency</th>
                          <th scope="col" style="font-size: 14px">Realiasi</th>
                          <th scope="col" style="font-size: 14px">RKAP</th>
                          <th scope="col" style="font-size: 14px">Outlook</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let item of listEditCurrency">
                          <td
                            scope="row"
                            style="font-size: 14px; border-style: none"
                          >
                            {{ item.kode }}
                          </td>
                          <td>{{ item.nilai_real }}</td>
                          <td>{{ item.nilia_rkap }}</td>
                          <td>{{ item.nilai_outlook }}</td>
                          <td>
                            <i
                              class="bi bi-plus-slash-minus"
                              style="cursor: pointer"
                              (click)="getValueRowKurs(item.kode)"
                            ></i>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <!-- </div> -->
                </div>
                <div class="modal-footer">
                  <button
                    type="button"
                    class="btn btn-secondary"
                    data-bs-dismiss="modal"
                  >
                    Tutup
                  </button>
                  <button type="button" class="btn btn-primary">Simpan</button>
                </div>
              </div>
            </div>
          </div>

          <div
            class="text-primary mt-2"
            [style.display]="isLoadingKurs ? 'block' : 'none'"
          >
            <div
              class="d-flex align-items-center justify-content-center bg-white rounded"
              style="padding: 50px 0px"
            >
              <div class="spinner-border" role="status"></div>
              <span class="text-dark ms-2">Load Data...</span>
            </div>
          </div>

          <!-- Card Commodity -->
          <div *ngIf="dataDefaultCurrency">
            <div
              *ngFor="let item of dataDefaultCurrency"
              [style.display]="isLoadingKurs ? 'none' : 'block'"
            >
              <div
                class="d-flex flex-column align-items-center justify-content-center bg-white rounded p-3 mb-3 mt-2 position-relative"
              >
                <span class="fw-semibold mb-3">{{ item.kode }}/IDR</span>
                <div
                  class="d-flex align-items-center justify-content-between"
                  style="font-size: 12px"
                >
                  <div
                    class="d-flex flex-column align-items-center me-2 text-danger"
                  >
                    <span>RKAP</span>
                    <span>{{ item.nilai_rkap }}</span>
                  </div>
                  <div
                    class="d-flex flex-column align-items-center me-2 text-primary"
                  >
                    <span>{{ item.alias_periode }}</span>
                    <span>{{ item.nilai_real }}</span>
                  </div>
                  <div
                    class="d-flex flex-column align-items-center text-secondary"
                  >
                    <span
                      >{{ getQuartal }}{{ getYear }}F<sup>{{
                        item.indikator_tagging
                      }}</sup></span
                    >
                    <span>{{ item.nilai_outlook }}</span>
                  </div>
                </div>
                <div
                  class="circle-card"
                  [style.background]="item.indikator"
                ></div>
              </div>
            </div>
          </div>
        </div>
        <div class="vertical-card col-4">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h4>Dampak thd Debt Service</h4>
            </div>
            <!-- <div>
            <button class="btn btn-light bg-white">Edit</button>
          </div> -->
          </div>
          <!-- Card Commodity -->
          <div
            class="d-flex flex-column align-items-center justify-content-center bg-white rounded p-3 mb-3 mt-2"
          >
            <span class="fw-semibold mb-3">Total Dampak Debt Service</span>
            <div
              class="d-flex align-items-center justify-content-between"
              style="font-size: 12px"
            >
              <div
                class="d-flex flex-column align-items-center me-2 text-danger"
              >
                <span>RKAP</span>
                <span>5.30</span>
              </div>
              <!-- <div class="d-flex flex-column align-items-center me-2 text-primary ">
              <span>TW II 2023</span>
              <span>5.17</span>
            </div> -->
              <div class="d-flex flex-column align-items-center text-secondary">
                <span>4Q23F4</span>
                <span>5.00</span>
              </div>
            </div>
          </div>
          <div
            class="d-flex flex-column align-items-center justify-content-center bg-white rounded p-3 mb-3"
          >
            <span class="fw-semibold mb-3">Angsuran Pokok</span>
            <div
              class="d-flex align-items-center justify-content-between"
              style="font-size: 12px"
            >
              <div
                class="d-flex flex-column align-items-center me-2 text-danger"
              >
                <span>RKAP</span>
                <span>5.30</span>
              </div>
              <!-- <div class="d-flex flex-column align-items-center me-2 text-primary ">
              <span>TW II 2023</span>
              <span>5.17</span>
            </div> -->
              <div class="d-flex flex-column align-items-center text-secondary">
                <span>4Q23F4</span>
                <span>5.00</span>
              </div>
            </div>
          </div>
          <div
            class="d-flex flex-column align-items-center justify-content-center bg-white rounded p-3 mb-3"
          >
            <span class="fw-semibold mb-3">Bunga Operasi</span>
            <div
              class="d-flex align-items-center justify-content-between"
              style="font-size: 12px"
            >
              <div
                class="d-flex flex-column align-items-center me-2 text-danger"
              >
                <span>RKAP</span>
                <span>5.30</span>
              </div>
              <!-- <div class="d-flex flex-column align-items-center me-2 text-primary ">
              <span>TW II 2023</span>
              <span>5.17</span>
            </div> -->
              <div class="d-flex flex-column align-items-center text-secondary">
                <span>4Q23F4</span>
                <span>5.00</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="d-flex align-items-center justify-content-between mt-4 mb-2">
        <div>
          <h4>Interest Rate</h4>
        </div>

        <div>
          <button
            class="btn btn-light bg-white"
            style="font-size: 14px"
            data-bs-toggle="modal"
            data-bs-target="#interestRate"
            [style.display]="isCapture ? 'none' : 'block'"
          >
            Edit
          </button>
        </div>
      </div>

      <div
        class="modal fade"
        id="interestRate"
        tabindex="-1"
        aria-labelledby="interestRateLabel"
        aria-hidden="true"
        data-bs-backdrop="true"
      >
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="currenciesModalLabel">
                Interest Rate
              </h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body overflow-y-auto">
              <!-- <div class="search search-bar" style="margin-bottom: 28px;">
              <form class="search-form" method="POST" action="#">
                <input type="text" name="query" placeholder="Search" title="Enter search keyword">
                <button type="submit" title="Search"><i class="bi bi-search"></i></button>
              </form>
            </div> -->
              <!-- <ng-select [items]="macroIndicatorSelect"
           bindLabel="name"
           bindValue="id"
           [(ngModel)]="selectedItems">
            </ng-select> -->
              <div>
                <div class="d-flex align-items-center justify-content-between">
                  <table class="table">
                    <thead>
                      <tr>
                        <th scope="col" style="font-size: 14px">
                          Interest Rate
                        </th>
                        <th scope="col" style="font-size: 14px">Realiasi</th>
                        <th scope="col" style="font-size: 14px">RKAP</th>
                        <th scope="col" style="font-size: 14px">Outlook</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let item of listEditInterest">
                        <td
                          scope="row"
                          style="font-size: 14px; border-style: none"
                        >
                          {{ item.keterangan }}
                        </td>
                        <td>{{ item.nilai_realisasi }}</td>
                        <td>{{ item.nilai_rkap }}</td>
                        <td>{{ item.nilai_outlook }}</td>
                        <td>
                          <i
                            class="bi bi-plus-slash-minus"
                            style="cursor: pointer"
                            (click)="getValueRowInterest(item.kode)"
                          ></i>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Tutup
              </button>
              <button type="button" class="btn btn-primary">Simpan</button>
            </div>
          </div>
        </div>
      </div>

      <div
        class="text-primary"
        [style.display]="isLoadingInterestRate ? 'block' : 'none'"
      >
        <div
          class="d-flex align-items-center justify-content-center bg-white rounded"
          style="padding: 50px 140px"
        >
          <div class="spinner-border" role="status"></div>
          <span class="text-dark ms-2">Load Data...</span>
        </div>
      </div>

      <!-- Card Macro Indicator -->
      <div [style.display]="isLoadingInterestRate ? 'none' : 'block'">
        <div class="d-flex flex-wrap align-items-center justify-content-center">
          <div *ngFor="let items of dataInterestRate">
            <div
              class="d-flex flex-column align-items-center justify-content-center bg-white rounded p-3 me-3 my-2 position-relative"
            >
              <span class="fw-semibold text-center mb-3"
                >{{ items.keterangan }} <span class="info-unit">(%)</span>
              </span>
              <div
                class="d-flex align-items-center justify-content-between pb-2"
                style="font-size: 12px"
              >
                <div
                  class="d-flex flex-column align-items-center me-2 text-danger"
                >
                  <span>RKAP</span>
                  <span>{{ items.nilai_rkap }}</span>
                </div>
                <div
                  class="d-flex flex-column align-items-center me-2 text-primary"
                >
                  <span>{{ items.alias_periode }}</span>
                  <span>{{ items.nilai_realisasi }}</span>
                </div>
                <div
                  class="d-flex flex-column align-items-center text-secondary"
                >
                  <span
                    >{{ getQuartal }}{{ getYear }}F
                    <sup>{{ items.indikator_tagging }}</sup></span
                  >
                  <span>{{ items.nilai_outlook }}</span>
                </div>
              </div>
              <div
                class="circle-card"
                [style.background]="items.indikator"
              ></div>
            </div>
          </div>
        </div>
      </div>

      <!-- key takeaway -->
      <div class="d-flex align-items-center justify-content-between mt-4 mb-2">
        <div class="fw-semibold">
          <h4>Key Takeways</h4>
        </div>
        <div>
          <button
            class="btn btn-light bg-white"
            type="button"
            style="font-size: 14px"
            (click)="openModalTakeways()"
            data-bs-toggle="modal"
            data-bs-target="#keytakewaysModal"
            [style.display]="isCapture ? 'none' : 'block'"
          >
            Edit
          </button>
        </div>
      </div>
      <!-- Modal -->
      <div
        class="modal fade"
        id="keytakewaysModal"
        tabindex="-1"
        aria-labelledby="keytakewaysModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-lg modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h4 class="modal-title fs-4" id="keytakewaysModalLabel">
                Key Takeways
              </h4>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body overflow-y-auto">
              <div
                #keyTakeways
                (click)="onChangeKeyTakeaways()"
                style="height: 250px"
              ></div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
              <button
                type="button"
                class="btn btn-primary"
                data-bs-dismiss="modal"
                (click)="getValueKeyTakeaways()"
              >
                Save changes
              </button>
            </div>
          </div>
        </div>
      </div>

      <div
        class="text-primary"
        [style.display]="isLoadingKeyTakeways ? 'block' : 'none'"
      >
        <div
          class="d-flex align-items-center justify-content-center bg-white rounded"
          style="padding: 50px 140px"
        >
          <div class="spinner-border" role="status"></div>
          <span class="text-dark ms-2">Load Data...</span>
        </div>
      </div>

      <div
        class="row bg-white p-3 rounded"
        [style.display]="isLoadingKeyTakeways ? 'none' : 'block'"
      >
        <div
          class="col-12"
          style="font-size: 12px"
          [innerHTML]="sanitize.bypassSecurityTrustHtml(getKeyTakeways)"
        ></div>
      </div>

      <div class="d-flex align-items-center justify-content-between mt-4 mb-2">
        <div class="fw-semibold">
          <h4>Footnote</h4>
        </div>
        <div>
          <button
            class="btn btn-light bg-white"
            style="font-size: 14px"
            data-bs-toggle="modal"
            (click)="openModalFootnote('')"
            data-bs-target="#footnoteModal"
            [style.display]="isCapture ? 'none' : 'block'"
          >
            Add
          </button>
        </div>
      </div>

      <!-- modal Footnote -->
      <div
        class="modal fade"
        id="footnoteModal"
        tabindex="-1"
        aria-labelledby="footnoteModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-lg modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="footnoteModalLabel">Footnote</h1>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body overflow-y-auto">
              <div
                #footnote
                style="height: 250px"
                (click)="onChangeFootnote()"
              ></div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
              <button
                type="button"
                class="btn btn-primary"
                data-bs-dismiss="modal"
                (click)="getValueFootnote()"
              >
                Save changes
              </button>
            </div>
          </div>
        </div>
      </div>
      <!-- end modal -->

      <div
        class="text-primary"
        [style.display]="isLoadingFootnote ? 'block' : 'none'"
      >
        <div
          class="d-flex align-items-center justify-content-center bg-white rounded"
          style="padding: 50px 140px"
        >
          <div class="spinner-border" role="status"></div>
          <span class="text-dark ms-2">Load Data...</span>
        </div>
      </div>

      <div
        class="row bg-white p-3 rounded"
        [style.display]="isLoadingFootnote ? 'none' : 'block'"
      >
        <div class="col-12" style="font-size: 12px">
          <ul class="list-group-flush">
            <ng-container *ngFor="let item of quillInnerHTMLFootnote">
              <li
                class="list-group-item d-flex justify-content-between align-items-start"
              >
                <div class="ms-2 me-auto">
                  <div class="btn-group dropup">
                    <button
                      type="button"
                      class="footnote-li btn btn-sm btn-light me-1"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                    >
                      {{ item.nomor }}
                    </button>
                    <ul class="dropdown-menu">
                      <!-- Dropdown menu links -->
                      <li>
                        <a
                          class="dropdown-item"
                          data-bs-toggle="modal"
                          (click)="editFootnote(item)"
                          data-bs-target="#footnoteModal"
                          >Edit</a
                        >
                      </li>
                      <li>
                        <a class="dropdown-item" (click)="deleteFootnote(item)"
                          >Delete</a
                        >
                      </li>
                    </ul>
                  </div>
                  <div
                    class="d-inline-block"
                    [innerHTML]="sanitize.bypassSecurityTrustHtml(item.note)"
                  ></div>
                </div>
              </li>
            </ng-container>
          </ul>
        </div>
      </div>
    </div>
    <!-- End Card Macro Indicator -->
  </main>
  <app-footer></app-footer>
</div>
